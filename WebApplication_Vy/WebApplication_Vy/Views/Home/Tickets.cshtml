@model List<WebApplication_Vy.Models.DTO.CustomerDTO>

@{
    ViewBag.Title = "Customers";
}
<script type="text/javascript">
    $(function () {

        $("#table").on("mouseenter", ".button-row", function () {
            console.log(this)
            $(this).css('cursor', 'pointer')
            $(this).css('background-color', '#e6e6e6')
        });

        $("#table").on("mouseleave", ".button-row", function () {
            console.log(this)
            $(this).css('background-color', '#ffffff')
        });

        $("#table").on("click", ".button-row", function () {
            console.log(this)
            $(this).next().slideToggle()
        });
        
        $("#table").on("click","#paymentDetails", function() {
           id =  $(this).val();
           console.log("this" + id);
           $.ajax({
                      url: "@Url.Action("GetPaymentDetails", "home")",
                      type: "POST",
                      data: JSON.stringify(id),
                      contentType: "application/json;charset=utf-8",
                      success: function (data) 
                      {
                          console.log(data);
                      },
                      error: function (x, y, z) {
                          alert(x + '\n' + y + '\n' + z);
                      }
                  });
        })
    });
</script>

<div class="row">
    <h2>Customers</h2>
</div>

<div class="row pl-1">
    <p>
        @Html.ActionLink("New Ticket", "Index", "", new { @class = "text-success" })
    </p>
</div>
<div id="table">
    @foreach (var item in Model)
    {
        <div class="row button-row p-3 border-top">
            <div class="col">
                @item.Givenname
            </div>
            <div class="col">
                @item.Surname
            </div>
        </div>
        <div id="hidden" class="mb-2" style="display:none">
            <table class="table table-striped">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col">Dep. Station</th>
                        <th scope="col">Arr. Station</th>
                        <th scope="col">Time</th>
                        <th scope="col">Duration</th>
                        <th scope="col">Price</th>
                        <th scope="col"></th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var t in item.Tickets)
                    {
                        <tr>
                            <th class="font-weight-bold">@t.DepartureStation</th>
                            <td class="font-weight-bold">@t.ArrivalStation</td>
                            <td>@t.DepartureTime - @t.ArrivalTime</td>
                            <td>@t.Duration</td>
                            <td>@t.Price</td>
                            <td>            
                                <div class="form-group">
                                    <div class="col-md-offset-2 col-md-10">
                                        <input type="submit" value="@t.Id" class="btn btn-success" id="paymentDetails"/>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }
</div>
